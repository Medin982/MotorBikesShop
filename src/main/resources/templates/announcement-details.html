<!doctype html>
<html lang="en"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="/css/bootstrap.min.css"/>
    <link rel="stylesheet" type="text/css" href="/css/main.css">
    <link rel="stylesheet" href="/css/announcement-details.css">
    <title>Details</title>
</head>
<body>
<nav th:replace="~{fragments/navBar}"></nav>
<div class="row">
    <h3 class="col-md-6 text-light font-weight-bold"
        th:object="${detailsViewModel}"
        th:text="|*{model.brand.name} *{model.name} *{modification}|">
        Brand name Model name</h3>

    <h4 class="col-md-6 text-primary font-weight-bold"
        th:object="${detailsViewModel}"
        th:text="|*{price}BGN|">
        Price</h4>
</div>

<section class="container" th:object="${detailsViewModel}">
    <div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
        <ol class="carousel-indicators">
            <li data-target="#carouselExampleIndicators" data-slide-to="1" class="active"
                th:if="${detailsViewModel.images.size() > 0}"></li>
            <li data-target="#carouselExampleIndicators" data-slide-to="2"
                th:if="${detailsViewModel.images.size() > 1}"></li>
            <li data-target="#carouselExampleIndicators" data-slide-to="3"
                th:if="${detailsViewModel.images.size() > 2}"></li>
            <li data-target="#carouselExampleIndicators" data-slide-to="4"
                th:if="${detailsViewModel.images.size() > 3}"></li>
            <li data-target="#carouselExampleIndicators" data-slide-to="5"
                th:if="${detailsViewModel.images.size() > 4}"></li>
        </ol>
        <div class="carousel-inner">
            <div class="carousel-item active" th:if="${detailsViewModel.images.size() > 0}">
                <img class="d-block w-100" th:src="${detailsViewModel.images.get(0).url}" alt="First slide">
            </div>
            <div class="carousel-item" th:if="${detailsViewModel.images.size() > 1}">
                <img class="d-block w-100" th:src="${detailsViewModel.images.get(1).url}" alt="Second slide">
            </div>
            <div class="carousel-item" th:if="${detailsViewModel.images.size() > 2}">
                <img class="d-block w-100" th:src="${detailsViewModel.images.get(2).url}" alt="Second slide">
            </div>
            <div class="carousel-item" th:if="${detailsViewModel.images.size() > 3}">
                <img class="d-block w-100" th:src="${detailsViewModel.images.get(3).url}" alt="Second slide">
            </div>
            <div class="carousel-item" th:if="${detailsViewModel.images.size() > 4}">
                <img class="d-block w-100" th:src="${detailsViewModel.images.get(4).url}" alt="Second slide">
            </div>
        </div>
        <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
        </a>
    </div>

    <article class="details">
        <div class="col">
            <div class="container-sm list-group text-warning bg-dark">
                <div class="card-text mb-1"
                     name="mileage">Mileage -
                    <span class="text-light" th:text="|*{mileage}KM|"></span>
                </div>
                <div class="card-text mb-1"
                     name="engineType">Engine -
                    <span class="text-light" th:text="*{engine}"></span>
                </div>
                <div class="card-text mb-1"
                     name="color">Color -
                    <span class="text-light" th:text="*{color}"></span>
                </div>
                <div class="card-text mb-1"
                     name="dateOfManufacture">
                    Date of Manufacture -
                    <span class="text-light" th:text="*{dateOfManufacture}"></span>
                </div>
                <div class="card-text mb-1"
                     name="category">Category -
                    <span class="text-light" th:text="*{category}"></span>
                </div>
                <div class="card-text mb-1"
                     name="conditions">Condition -
                    <span class="text-light" th:text="*{conditions}"></span>
                </div>
                <div class="card-text mb-1"
                     name="modification">Modification -
                    <span class="text-light" th:text="*{modification}"></span>
                </div>
            </div>
        </div>

        <div class="col">
            <div class="container-sm list-group text-warning bg-dark">
                <h5 class="table-info bg-dark">
                    Description
                </h5>
                <div class="card-text mb-1"
                     name="description">
                    <span class="text-light" th:text="*{description}"></span>
                </div>
            </div>
        </div>
    </article>
</section>

<section class="contact">
    <div class="container-fluid text-warning bg-dark">
        <h5 class="font-weight-bold">
            Contacts:
        </h5>
        <div class="row">
            <div class="col-md-2">
                <div th:object="${detailsViewModel.seller}">
                    <div class="mb-1"
                         name="name">Seller:
                        <span class="text-light" th:text="|*{firstName} *{lastName}|"></span>
                    </div>
                    <div class="mb-1"
                         name="phoneNumber">Phone:
                        <span class="text-light" th:text="*{phoneNumber}"></span>
                    </div>
                </div>
                <div th:object="${detailsViewModel.address}">
                    <div class="mb-1"
                         name="address"> Street:
                        <span class="text-light" th:text="|*{street} *{streetNumber}|"></span>
                    </div>
                    <div class="mb-1"
                         name="address"> City:
                        <span class="text-light" th:text="|*{city.name}|"></span>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div id="map-container-google-2" class="z-depth-1-half map-container" style="height: 250px">
                    <iframe src="https://maps.google.com/maps?q=chicago&t=&z=13&ie=UTF8&iwloc=&output=embed"></iframe>
                </div>
            </div>
            <div class="col-md-6">
                <form th:action="@{/announcement/details/{id}(id = ${detailsViewModel.announcementId})}"
                      th:method="POST"
                      th:object="${emailRequestDTO}">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="md-form mb-0">
                                <input type="text" id="name"
                                       th:field="*{firstName}"
                                       th:errorclass="is-invalid"
                                       placeholder="Your name"
                                       class="form-control">
                                <p class="invalid-feedback errors alert alert-danger">
                                    First name is required.
                                </p>
                                <label for="name" class="">First Name</label>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="md-form mb-0">
                                <input type="text"
                                       id="lastName"
                                       th:field="*{lastName}"
                                       th:errorclass="is-invalid"
                                       placeholder="Last Name"
                                       class="form-control">
                                <p class="invalid-feedback errors alert alert-danger">
                                    Last name is required.
                                </p>
                                <label for="lastName" class="">Last Name</label>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="md-form mb-0">
                                <input type="text"
                                       id="email"
                                       th:field="*{email}"
                                       th:errorclass="is-invalid"
                                       placeholder="Your email"
                                       class="form-control">
                                <p class="invalid-feedback errors alert alert-danger">
                                    Email is required.
                                </p>
                                <label for="email" class="">Email</label>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="md-form mb-0">
                                <input type="number"
                                       id="phoneNumber"
                                       th:field="*{phoneNumber}"
                                       th:errorclass="is-invalid"
                                       placeholder="Phone"
                                       class="form-control">
                                <p class="invalid-feedback errors alert alert-danger">
                                    Phone Number is required.
                                </p>
                                <label for="phoneNumber" class="">Phone Number</label>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="md-form">
                                <textarea type="text"
                                          id="message"
                                          th:field="*{message}"
                                          th:errorclass="is-invalid"
                                          placeholder="Your message"
                                          rows="2"
                                          class="form-control md-textarea"></textarea>
                                <p class="invalid-feedback errors alert alert-danger">
                                    Message is required.
                                </p>
                                <label for="message">Your message</label>
                            </div>
                            <button type="submit"
                                    class="btn btn-success btn-block btn-lg gradient-custom-4 text-body">Send
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</section>
<!--It works,but we display two delete button if user is admin and is owner.-->
<div class="card-body text-danger font-weight-bold"
     th:if="${user} == ${detailsViewModel.seller.email}">
    <form th:action="@{/announcement/delete/{id}(id = *{id})}"
          th:method="delete">
        <input type="submit" value="Delete">
    </form>
</div>
<div class="card-body text-danger font-weight-bold"
     sec:sec:authorize="hasRole('ADMIN')">
    <form th:action="@{/announcement/delete/{id}(id = *{id})}"
          th:method="delete">
        <input type="submit" value="Delete">
    </form>
</div>

<footer th:replace="~{fragments/footer :: footer-user}"></footer>
<th:block th:replace="~{fragments/scripts}"></th:block>
</body>
</html>